@model SellerBox.Models.Database.Auction
@section scripts {
    <script src="https://vk.com/js/api/openapi.js?159" type="text/javascript"></script>
}
@{
    ViewBag.Title = "Создание аукциона";
    Layout = "_Layout";
}
<h2>Создание аукциона</h2>
<form asp-antiforgery="true" asp-action="Create" method="post">
    <div asp-validation-summary="All" class="text-danger"></div>
    <div class="input-group-prepend">
        <label asp-for="Name" class="input-group-text"></label>
        <input id="name" asp-for="Name" class="form-control"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="Description" class="input-group-text"></label>
        <input asp-for="Description" class="form-control"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="StartDate" class="input-group-text"></label>
        <input asp-for="StartDate" class="form-control" value="@DateTime.Now"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="EndDate" class="input-group-text"></label>
        <input asp-for="EndDate" class="form-control" value="@DateTime.Now.AddDays(1)"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="StartPrice" class="input-group-text"></label>
        <input asp-for="StartPrice" class="form-control" />
    </div>
    <div class="input-group-prepend">
        <label asp-for="PriceStep" class="input-group-text"></label>
        <input asp-for="PriceStep" class="form-control"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="MaxPrice" class="input-group-text"></label>
        <input asp-for="MaxPrice" class="form-control"/>
    </div>
    <div class="input-group-prepend">
        <label asp-for="MaxCommentsCount" class="input-group-text"></label>
        <input asp-for="MaxCommentsCount" class="form-control"/>
    </div>
    <input id="btntest" type="button" value="Сохранить" class="btn btn-primary" onclick="auth()"/>
</form>
<!--
<div id="vk_api_transport"></div>
<script type="text/javascript">
    window.vkAsyncInit = function() {
        VK.init({
            apiId: @ViewBag.AppId
        });
    };

    setTimeout(function() {
        var el = document.createElement("script");
        el.type = "text/javascript";
        el.src = "https://vk.com/js/api/openapi.js?159";
        el.async = true;
        document.getElementById("vk_api_transport").appendChild(el);
    }, 0);
</script>
-->
<script type="text/javascript">
    VK.init({
        apiId:  @ViewBag.AppId
    });
</script>
<script type="text/javascript">
    function auth() {
        VK.Auth.login(authInfo, VK.access.WALL);
    }
    //Тест авторизации
    function authInfo(response) {
        if (response.session) {
            Wall();
        }
    }
    
    function Wall() {
        VK.Api.call('wall.post', { ownerId: @ViewBag.OwnerId, message: "test message from js", from_group: 1, v: "5.87" }), function(r) {
            if (r.response) {
                alert(r.response[0]);
            }
        }
    }
</script>